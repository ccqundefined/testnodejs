<% include ../public/page_header.html %>
<script src="/public/admin/jqPaginator/jq-paginator.min.js"></script>
<div class="panel panel-default">
    <div class="panel-heading">
<span>商品列表</span> <a class="btn btn-primary pull-right" href="/admin/goods/add">增加商品类型</a>
</div>
    <div class="panel-body">
        <form role="form" class="form-inline" method="GET" action="/admin/goods">
            <div class="form-group">
                <label for="name">输入关键词</label>
                <input type="text" class="form-control" id="name" placeholder="请输入名称" name="keyword" value="<%=keywords%>">
            </div>
    
            <div class="form-group">
                <button type="submit" class="btn btn-default">开始搜索</button>
            </div>
        </form>
        <div class="table-responsive input-form">
           <table class="table table-bordered">
               <thead>
                   <tr class="th">
                        <th>商品名称</th>
                        <th>货号</th>
                        <th>价格</th>
                        <th>点击量</th>
                        <th>上架</th>

                        <th>精品</th>
                        <th>新品</th>
                        <th>热销</th>
                        <th>推荐排序</th>
                        <th>库存</th>
                        <th class="text-center">操作</th>
                   </tr>
               </thead>
               <tbody>
                   <%for(let i = 0; i < list.length; i++){%>
                    <tr>
                        <td><%=list[i].title%></td>
                        <td><%=list[i].goods_sn%></td>
                        <td><%=list[i].shop_price%></td>
                        <td><%=list[i].click_count%></td>
                        <td class="text-center">
                            <%if(list[i].status == 1){%>
                                <img src="/public/admin/images/yes.gif" onclick="app.changeStatus(this,'Goods','status','<%=list[i]._id%>')">
                            <%}else{%>
                                <img src="/public/admin/images/no.gif" onclick="app.changeStatus(this,'Goods','status','<%=list[i]._id%>')">
                            <%}%>        
                        </td>
                        <td class="text-center">
                            <%if(list[i].is_best == 1){%>
                                <img src="/public/admin/images/yes.gif" onclick="app.changeStatus(this,'Goods','is_best','<%=list[i]._id%>')">
                            <%}else{%>
                                <img src="/public/admin/images/no.gif" onclick="app.changeStatus(this,'Goods','is_best','<%=list[i]._id%>')">
                            <%}%>        
                        </td>
                        <td class="text-center">
                            <%if(list[i].is_new == 1){%>
                                <img src="/public/admin/images/yes.gif" onclick="app.changeStatus(this,'Goods','is_new','<%=list[i]._id%>')">
                            <%}else{%>
                                <img src="/public/admin/images/no.gif" onclick="app.changeStatus(this,'Goods','is_new','<%=list[i]._id%>')">
                            <%}%>        
                        </td>
                        <td class="text-center">
                            <%if(list[i].is_hot == 1){%>
                                <img src="/public/admin/images/yes.gif" onclick="app.changeStatus(this,'Goods','is_hot','<%=list[i]._id%>')">
                            <%}else{%>
                                <img src="/public/admin/images/no.gif" onclick="app.changeStatus(this,'Goods','is_hot','<%=list[i]._id%>')">
                            <%}%>        
                        </td>
                        <td class="text-center">
                            <span onclick="app.editNum(this,'Goods','sort','<%=list[i]._id%>')"><%=list[i].sort%></span>
                        </td>
                        <td class="text-center">
                            <span onclick="app.editNum(this,'Goods','goods_number','<%=list[i]._id%>')"><%=list[i].goods_number%></span>
                        </td>
                        <td class="text-center">
                            <a href="/admin/goods/edit?id=<%=list[i]._id%>">修改</a>
                            <a href="/admin/delete?id=<%=list[i]._id%>&model=Goods">删除</a>
                        </td>
                    </tr>
                   <%}%> 
               </tbody>
           </table>
           
  
            <ul id="page" class="pagination pull-right">
                <li class="disabled"><a href="#" aria-label="Previous"><span aria-hidden="true">&laquo;</span></a></li>
                <li class="active"><a href="#">1 <span class="sr-only">(current)</span></a></li>

                ...
              </ul>
 
                
        </div>
    </div>

</div>
    <script>
        $.jqPaginator('#page', {
        totalPages: <%=totalNum%>,
        visiblePages: 8,
        currentPage: <%=page%>,
        first: '<li class="first"><a href="javascript:void(0);">首页</a></li>',
        prev: '<li class="prev"><a href="javascript:void(0);">上一页</a></li>',
        next: '<li class="next"><a href="javascript:void(0);">下一页</a></li>',
        last: '<li class="last"><a href="javascript:void(0);">最后一页</a></li>',
        page: '<li class="page"><a href="javascript:void(0);">{{page}}</a></li>',

       //num为当前页码，type为当前状态，分为“init”（初始化），“change”（点击分页）
        onPageChange: function (num, type) {
            console.log('当前第'+num+'页',type)
            if(type == 'change'){
                location.href = '/admin/goods?page='+num+'&keyword=<%=keywords%>';
            }
        }
    });
    </script>
    </body>
</html>
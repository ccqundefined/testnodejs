<%- include ../public/page_header.html %>
<script src="/public/admin/jqPaginator/jq-paginator.min.js"></script>
<div class="panel panel-default">
    <div class="panel-heading clearfix">
<span>文章列表</span> <a href="/admin/article/add" class="btn btn-primary pull-right">增加文章</a>
</div>
    <div class="panel-body">
        <div class="table-responsive"> 
                <table class="table table-bordered">
                    <thead>
                        <tr class="th">
                            <th>文章名称</th>
                            <th>文章图片</th>
                            <th>所属分类</th>
                            <th>增加日期</th>
                            <th class="text-center">排序</th>
                            <th class="text-center">状态</th>
                            <th class="text-center">操作</th>
                        </tr>
                    </thead>
                    <tbody>
                        <%for(let i = 0; i < list.length; i++){%>
                            <tr>
                                <td><%=list[i].title%></td>
                                <td><img src="<%=list[i].article_img%>" class="pic"></td>
                                <td>
                                    <%=list[i].cate_list[0].title%>
                                </td>
                                <td>
                                    <%=helper.formatTime(list[i].add_time)%>
                                </td>
                                <td class="text-center">
                                    <span onclick="app.editNum(this,'Article','sort','<%=list[i]._id%>')"><%=list[i].sort%></span>
                                </td>
                                <td class="text-center">
                                    <%if(list[i].status == 1){%>
                                    <img src="/public/admin/images/yes.gif" 
                                    onclick="app.changeStatus(this,'Article','status','<%=list[i]._id%>')" alt=""> 
                                <%}else{%>
                                    <img src="/public/admin/images/no.gif" 
                                    onclick="app.changeStatus(this,'Article','status','<%=list[i]._id%>')" alt="">
                                    <%}%>
                                </td>
                                <td class="text-center">
                                    <a href="/admin/article/edit?id=<%=list[i]._id%>">编辑</a>
                                    <a class="delete" href="/admin/article/delete?model=Article&id=<%=list[i]._id%>">删除</a>
                                </td>
                            </tr>
                        <%}%>    
                    </tbody>
                </table>
                <ul id="page" class="pagination pull-right">
                    <li class="disabled"><a href="#" aria-label="Previous"><span aria-hidden="true">&laquo;</span></a></li>
                    <li class="active"><a href="#">1 <span class="sr-only">(current)</span></a></li>
    
                    ...
                  </ul>
        </div>
    </div>

</div>
<script>
    $.jqPaginator('#page', {
    totalPages: <%=totalPages%>,
    visiblePages: 8,
    currentPage: <%=page%>,
    first: '<li class="first"><a href="javascript:void(0);">首页</a></li>',
    prev: '<li class="prev"><a href="javascript:void(0);">上一页</a></li>',
    next: '<li class="next"><a href="javascript:void(0);">下一页</a></li>',
    last: '<li class="last"><a href="javascript:void(0);">最后一页</a></li>',
    page: '<li class="page"><a href="javascript:void(0);">{{page}}</a></li>',

   //num为当前页码，type为当前状态，分为“init”（初始化），“change”（点击分页）
    onPageChange: function (num, type) {
        console.log('当前第'+num+'页',type)
        if(type == 'change'){
            location.href = '/admin/article?page='+num;
        }
    }
});
</script>
    </body>
</html>